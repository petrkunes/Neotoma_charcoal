PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::group_by(depth, age) %>%
dplyr::select(depth, age, variablename, value)
View(PRA_charcoal)
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
# dplyr::select(depth, age, variablename, value) %>%
dplyr::group_by(depth, age)
View(PRA_charcoal)
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::group_by(depth, age)
?mutate
View(PRA_charcoal)
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "))
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "))
View(PRA_charcoal)
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "))
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), keep = "used")
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "used")
View(PRA_charcoal)
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused")
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value,
values_fill = 0))
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value
values_fill = 0))
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value
values_fill = 0)
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value,
values_fill = 0)
View(PRA_charcoal_wide)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide, PRA_charcoal_wide[,1:2])
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2])
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2])
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2], riojaPlot = PRA_plot)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
plot.sec.axis = TRUE,
xRight = 0.9)
View(PRA_pollen_wide)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age"
plot.sec.axis = TRUE,
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="Age",
plot.sec.axis = TRUE,
xRight = 0.9)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
xmax = 10
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
xmax = 10,
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
x.max = 10,
riojaPlot = PRA_plot)
?riojaPlot
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
xlim = 10,
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
x.lim = 10,
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = c(0,10),
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,10),
riojaPlot = PRA_plot)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
riojaPlot = PRA_plot)
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value,
orderby = depth,
values_fill = 0)
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value,
order_by = depth,
values_fill = 0)
View(PRA_charcoal_wide)
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value,
values_fill = 0)
View(PRA_charcoal_wide)
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused")
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused")
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused") %>%
dplyr::group_by(depth, age) %>%
dplyr::arrange(asc(depth))
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused") %>%
dplyr::group_by(depth, age)
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value,
values_fill = 0)
View(PRA_charcoal_wide)
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused") %>%
dplyr::group_by(depth, age) %>%
dplyr::arrange(depth)
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value,
values_fill = 0)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
riojaPlot = PRA_plot)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
riojaPlot = PRA_plot)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
riojaPlot = PRA_plot)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
col.bar = "black"
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
col = "black"
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
col.bar = "black",
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
col.group = "black",
riojaPlot = PRA_plot)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
col.group = "black",
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
lwd.bar = 3,
col.group = "black",
riojaPlot = PRA_plot)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
lwd.bar = 2,
col.group = "black",
riojaPlot = PRA_plot)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
lwd.bar = 2,
col.group = "black",
riojaPlot = PRA_plot)
?riojaPlot
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
lwd.bar = 2,
col.bar = "black",
riojaPlot = PRA_plot)
install.packages("rmarkdown")
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
summary(cars)
plot(pressure)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
summary(cars)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
devtools::install_github('NeotomaDB/neotoma2')
library(neotoma2)
library(riojaPlot)
knit_with_parameters("~/Documents/GitHub/Neotoma_charcoal/Neotoma_charcoal.Rmd")
styler:::set_style_transformers()
pandoc_version())
install.packages("pandoc")
library(pandoc)
# Select Prášilské jezero (CZ) and extract samples
PRA_ds <- get_datasets(get_sites(sitename = "Prášilské jezero"), all_data = TRUE)
plotLeaflet(PRA_ds)
View(PRA_ds)
View(PRA_ds)
View(PRA_ds)
?get_datasets
PRA_ds <- get_datasets(get_sites(sitename = "Prášilské jezero"), all_data = TRUE)
plotLeaflet(PRA_ds)
knitr::opts_chunk$set(echo = TRUE)
devtools::install_github('NeotomaDB/neotoma2')
library(neotoma2)
library(riojaPlot)
unlink("Neotoma_charcoal_cache", recursive = TRUE)
PRA_ds <- get_datasets(get_sites(sitename = "Prášilské jezero"), all_data = TRUE)
plotLeaflet(PRA_ds)
PRA_ds <- get_datasets(get_sites(sitename = "Prášilské jezero"), all_data = TRUE)
plotLeaflet(PRA_ds)
PRA_ds <- get_datasets(get_sites(sitename = "Prášilské jezero"), all_data = TRUE)
plotLeaflet(PRA_ds)
#
PRA_pol_ch <- PRA_ds %>% neotoma2::filter(datasettype %in% c("pollen", "charcoal"))
View(PRA_pol_ch)
PRA_samp <- PRA_rec %>% samples()
# Pull in and extract sample data
PRA_rec <- PRA_pol_ch %>% get_downloads()
PRA_samp <- PRA_rec %>% samples()
View(PRA_samp)
# Select charcoal area
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused") %>%
dplyr::group_by(depth, age) %>%
dplyr::arrange(depth)
View(PRA_charcoal)
# Select only pollen taxa (and only trees/shrubs) for plotting
PRA_plot_taxa <- taxa(PRA_rec) %>% dplyr::filter(ecologicalgroup %in% c("TRSH")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::arrange(desc(samples)) %>%
head(n = 15)
View(PRA_plot_taxa)
View(PRA_plot_taxa)
View(PRA_plot_taxa)
rm(PRA_plot_taxa)
# Select pollen taxa for calculation pollen sum and %
PRA_taxa_sum <- taxa(PRA_rec) %>% dplyr::filter(ecologicalgroup %in% c("TRSH", "UPHE")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::arrange(desc(samples))
View(PRA_taxa_sum)
View(PRA_taxa_sum)
PRA_taxa_sum <- taxa(PRA_rec) %>% dplyr::filter(ecologicalgroup %in% c("TRSH", "UPHE")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::arrange(desc(samples))
knitr::opts_chunk$set(echo = TRUE)
devtools::install_github('NeotomaDB/neotoma2')
library(neotoma2)
library(riojaPlot)
PRA_ds <- get_datasets(get_sites(sitename = "Prášilské jezero"), all_data = TRUE)
plotLeaflet(PRA_ds)
PRA_pol_ch <- PRA_ds %>% neotoma2::filter(datasettype %in% c("pollen", "charcoal"))
PRA_rec <- PRA_pol_ch %>% get_downloads()
PRA_samp <- PRA_rec %>% samples()
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused") %>%
dplyr::group_by(depth, age) %>%
dplyr::arrange(depth)
View(PRA_taxa_sum)
# Select only pollen samples measured using NISP.
PRA_samp_short <- samples(PRA_rec) %>%
dplyr::filter(variablename %in% PRA_taxa_sum$variablename) %>%
dplyr::filter(ecologicalgroup %in% c("TRSH","UPHE")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::filter(units == "NISP")
# Select only pollen samples measured using NISP.
PRA_samp_short <- samples(PRA_rec) %>%
# dplyr::filter(variablename %in% PRA_taxa_sum$variablename) %>%
dplyr::filter(ecologicalgroup %in% c("TRSH","UPHE")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::filter(units == "NISP")
View(PRA_samp_short)
# Select only pollen samples measured using NISP.
PRA_samp_short <- samples(PRA_rec) %>%
dplyr::filter(variablename %in% PRA_taxa_sum$variablename) %>%
dplyr::filter(ecologicalgroup %in% c("TRSH","UPHE")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::filter(units == "NISP")
# Transform to proportion values.
PRA_pollen_perc <- PRA_samp_short %>%
dplyr::group_by(depth, age) %>%
dplyr::mutate(pollencount = sum(value, na.rm = TRUE)) %>%
dplyr::group_by(variablename) %>%
dplyr::mutate(prop = value / pollencount) %>%
dplyr::arrange(desc(age))
View(PRA_pollen_perc)
PRA_rec <- PRA_pol_ch %>% get_downloads()
PRA_samp <- PRA_rec %>% samples()
View(PRA_taxa_sum)
View(allids)
# Select only pollen taxa (and only trees/shrubs) for plotting
PRA_plot_taxa <- taxa(PRA_rec) %>% dplyr::filter(ecologicalgroup %in% c("TRSH")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::arrange(desc(samples)) %>%
head(n = 15)
View(PRA_plot_taxa)
PRA_rec <- PRA_pol_ch %>% get_downloads()
PRA_samp <- PRA_rec %>% samples()
PRA_rec <- PRA_pol_ch %>% get_downloads()
PRA_samp <- PRA_rec %>% samples()
PRA_pol_ch <- PRA_ds %>% neotoma2::filter(datasettype %in% c("pollen", "charcoal"))
PRA_ds <- get_datasets(get_sites(sitename = "Prášilské jezero"), all_data = TRUE)
plotLeaflet(PRA_ds)
unlink("Neotoma_charcoal_cache", recursive = TRUE)
tinytex::install_tinytex()
tinytex::install_tinytex()
tinytex::install_tinytex()
tinytex::install_tinytex()
unlink("Neotoma_charcoal_cache", recursive = TRUE)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
srt.xlabel = 60,
xRight = 0.9)
library(riojaPlot)
library(neotoma2)
# Select Prášilské jezero (CZ)
PRA_ds <- get_datasets(get_sites(sitename = "Prášilské jezero"), all_data = TRUE)
plotLeaflet(PRA_ds)
# Filter our the datasets from pollen and charcoal
PRA_pol_ch <- PRA_ds %>% neotoma2::filter(datasettype %in% c("pollen", "charcoal"))
# Pull in and extract sample data
PRA_rec <- PRA_pol_ch %>% get_downloads()
# Pull in and extract sample data
PRA_rec <- PRA_pol_ch %>% get_downloads()
PRA_samp <- PRA_rec %>% samples()
# Select charcoal area
PRA_charcoal <- samples(PRA_rec) %>% dplyr::filter(ecologicalgroup == "CHAR" & elementtype == "area") %>%
dplyr::select(depth, age, variablename, elementtype, value) %>%
dplyr::mutate(variable = paste(variablename, elementtype, sep = " "), .keep = "unused") %>%
dplyr::group_by(depth, age) %>%
dplyr::arrange(depth)
# Select only pollen samples measured using NISP and taxa for calculating %.
PRA_samp_short <- samples(PRA_rec) %>%
dplyr::filter(ecologicalgroup %in% c("TRSH","UPHE")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::filter(units == "NISP")
# Transform to proportion values.
PRA_pollen_perc <- PRA_samp_short %>%
dplyr::group_by(depth, age) %>%
dplyr::mutate(pollencount = sum(value, na.rm = TRUE)) %>%
dplyr::group_by(variablename) %>%
dplyr::mutate(prop = value / pollencount) %>%
dplyr::arrange(desc(age))
# Spread the data to a "wide" table, with taxa as column headings. Both pollen and charcoal
PRA_pollen_perc <- PRA_pollen_perc %>%
dplyr::select(depth, age, variablename, prop) %>%
dplyr::mutate(prop = as.numeric(prop))
PRA_pollen_wide <- tidyr::pivot_wider(PRA_pollen_perc,
id_cols = c(depth, age),
names_from = variablename,
values_from = prop,
values_fill = 0)
PRA_charcoal_wide <- tidyr::pivot_wider(PRA_charcoal,
id_cols = c(depth, age),
names_from = variable,
values_from = value,
values_fill = 0)
# Select only pollen taxa (and only trees/shrubs) for plotting
PRA_plot_taxa <- taxa(PRA_rec) %>% dplyr::filter(ecologicalgroup %in% c("TRSH")) %>%
dplyr::filter(elementtype == "pollen") %>%
dplyr::arrange(desc(samples)) %>%
head(n = 15)
PRA_plot <- riojaPlot(PRA_pollen_wide[,-1:-2]*100, PRA_pollen_wide[,1:2],
selVars = PRA_plot_taxa$variablename,
scale.percent = TRUE,
sec.yvar.name="age",
plot.sec.axis = TRUE,
srt.xlabel = 60,
xRight = 0.9)
riojaPlot(PRA_charcoal_wide[,-1:-2], PRA_charcoal_wide[,1:2],
minmax = data.frame(0,6),
plot.poly = FALSE,
plot.bar = TRUE,
plot.line = FALSE,
lwd.bar = 2,
col.bar = "black",
riojaPlot = PRA_plot)
